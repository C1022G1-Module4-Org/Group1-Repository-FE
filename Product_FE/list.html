<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
            integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"
            integrity="sha384-mQ93GR66B00ZXjt0YO5KlohRA5SY2XofN4zfuZxLkoj1gXtW8ANNCe9d5Y3eG5eD"
            crossorigin="anonymous"></script>

</head>
<body>
<input type="text" id="search" placeholder="search">
<button id="find" value="Tìm">Tìm</button>
<table class="table"></table>
<button id="next">More</button>
</body>
<h1>Toy List</h1>
<!--<table class="table table-striped">-->
<!--    <tr>-->
<!--        <th>id</th>-->
<!--        <th>Name</th>-->
<!--        <th>Price</th>-->
<!--        <th>Description</th>-->
<!--        <th>brand</th>-->
<!--        <th>origin</th>-->
<!--        <th>material</th>-->

<!--    </tr>-->
<!--    <tbody id="table"></tbody>-->
<!--</table>-->

<form id="add-toy">
    <table>
        <tr>
            <td>Name:</td>
            <td><input type="text" id="name" placeholder="name"></td>
        </tr>
        <tr>
            <td>Price:</td>
            <td><input type="text" id="price" placeholder="price"></td>
        </tr>
        <tr>
            <td>Description:</td>
            <td><input type="text" id="description" placeholder="description"></td>
        </tr>
        <tr>
            <td>Brand:</td>
            <td><input type="text" id="brand" placeholder="brand"></td>
        </tr>
        <tr>
            <td>Origin:</td>
            <td><input type="text" id="origin" placeholder="origin"></td>
        </tr>
        <tr>
            <td>Material:</td>
            <td><input type="text" id="material" placeholder="material"></td>
        </tr>
        <tr>
            <td></td>
            <td><input type="button" value="Add" onclick="addNewToy()"></td>
        </tr>
    </table>
</form>
<table class="list" border="1" cellpadding="10">
</table>
<script>
    showList();

    function showList(search, pageSize) {
        $(".list").init();
        $.ajax({
            type: "GET",
            dataType: "json",
            url: `http://localhost:8080/api/toy?name=` + search,
            success: function (data) {
                let tr = [];
                // $(".list").empty()
                tr.push("<tr><th>Id</th><th>Name</th><th>Price</th><th>Description</th><th>Brand</th><th>Origin</th><th>Material</th></tr>")
                for (let i = 0; i < data.length; i++) {
                    tr.push("<tr>");
                    tr.push("<td>" + data[i].id + "</td>");
                    tr.push("<td>" + data[i].name + "</td>");
                    tr.push("<td>" + data[i].price + "</td>");
                    tr.push("<td>" + data[i].description + "</td>");
                    tr.push("<td>" + data[i].brand + "</td>");
                    tr.push("<td>" + data[i].origin + "</td>");
                    tr.push("<td>" + data[i].material + "</td>");
                    tr.push(`<td><button onclick="removeById(` + data[i].id + `)">Delete</button></td>`);
                    tr.push("</tr>");
                }
                $(".list").html(tr);
                // console.log(data)
                // let contens = "";
                // for (let i = 0; i < data.length; i++) {
                //     contens += `<tr>`
                //     contens += `<td>${data[i].id}</td>`
                //     contens += `<td>${data[i].name}</td>`
                //     contens += `<td>${data[i].price}</td>`
                //     contens += `<td>${data[i].description}</td>`
                //     contens += `<td>${data[i].brand}</td>`
                //     contens += `<td>${data[i].origin}</td>`
                //     contens += `<td>${data[i].material}</td>`
                //     contens += `</tr>`
                //
                //
                // }
                // $('#table').html(contens)
            }
        })

    }

    $(document).ready(function () {
        let nameSearch = "";
        let sizePage = 1;
        showList(nameSearch, sizePage);
        $('#find').click(function () {
            sizePage = 1;
            let nameSearch = $('#search').val();
            showList(nameSearch, sizePage);
        })
        $(`#next`).click(function () {
            let nameSearch = $('#search').val()
            sizePage++;
            showList(nameSearch, sizePage);
        })

    })

    function addNewToy() {
        let name = $('#name').val();
        let price = $('#price').val();
        let description = $('#description').val();
        let branđ = $('#brand').val();
        let origin = $('#origin').val();
        let material = $('#material').val();
        let newToy = {
            name: name,
            price: price,
            description: description,
            brand: branđ,
            origin: origin,
            material: material
        };
        $.ajax({
            type: "POST",
            data: JSON.stringify(newToy),
            url: "http://localhost:8080/api/create",
            headers: {
                'Content-Type': 'application/json'
            },
            success: function (data) {
            },
            complete: function (data) {
                console.log(data)
                showList();
            }
        });
    }

    function removeById(id) {
        $.ajax({
            url: "http://localhost:8080/api/" + id,
            type: "DELETE",
            success: function () {
                alert("Delete success");
                showList();
            }
        })
    }






</script>
</html>